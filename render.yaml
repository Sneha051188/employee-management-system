services:
  # Backend Spring Boot API
  - type: web
    name: ems-backend
    runtime: docker
    dockerfilePath: ./ems-backend/Dockerfile
    dockerContext: ./ems-backend
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: ems-db
          property: connectionString
      - key: PORT
        value: 8080
    healthCheckPath: /api/employees

  # MySQL Database
  - type: pserv
    name: ems-db
    runtime: docker
    dockerfilePath: ./ems-backend/mysql.Dockerfile
    dockerContext: ./ems-backend
    disk:
      name: mysql-data
      mountPath: /var/lib/mysql
      sizeGB: 1
    envVars:
      - key: MYSQL_ROOT_PASSWORD
        generateValue: true
      - key: MYSQL_DATABASE
        value: companydb
